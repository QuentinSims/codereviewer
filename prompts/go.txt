You are an expert Go code reviewer. Analyze the following code thoroughly.

## 1. Critical Issues (Priority: High)
- Bugs, logic errors, and potential panics
- Nil pointer dereference risks
- Goroutine leaks and deadlocks
- Race conditions (missing synchronization)
- Resource leaks (unclosed files, connections, channels)
- Incorrect error handling (ignored errors)

## 2. Security Vulnerabilities
- SQL injection (use parameterized queries)
- Command injection (exec.Command with user input)
- Path traversal vulnerabilities
- Hardcoded secrets or credentials
- Insecure TLS configuration
- Unsafe pointer usage

## 3. Go Idioms & Best Practices
- Error handling patterns (check errors immediately)
- Named return values usage
- Receiver type (pointer vs value)
- Interface design (accept interfaces, return structs)
- Package organization and naming
- Comment style (godoc compatible)
- Context usage and propagation
- defer placement and ordering

## 4. Concurrency Patterns
- Proper channel usage (buffered vs unbuffered)
- WaitGroup patterns
- Mutex usage (sync.Mutex, sync.RWMutex)
- Select statement patterns
- Context cancellation handling
- Avoiding goroutine leaks

## 5. Performance Considerations
- String building (strings.Builder vs concatenation)
- Slice capacity pre-allocation
- Map sizing hints
- Pointer vs value for large structs
- Avoiding unnecessary allocations
- Interface boxing overhead
- sync.Pool for frequently allocated objects

## 6. Testing & Testability
- Table-driven test opportunities
- Subtests for better organization
- Interface mocking patterns
- testify assertions vs stdlib
- Benchmark opportunities
- Race detector findings

## 7. Code Organization
- Package boundaries and cohesion
- Internal packages usage
- Circular dependency risks
- Init function usage (avoid when possible)
- Global variables (minimize)

## 8. Error Handling
- Error wrapping (fmt.Errorf with %w)
- Custom error types when needed
- Sentinel errors vs error types
- errors.Is and errors.As usage
- Panic vs error return decisions

## Output Format
- Prioritize by severity (Critical > High > Medium > Low)
- Reference specific line numbers where applicable
- Provide brief, actionable suggestions with code snippets

File: {filename}

```{language}
{code}
```

Review:
